2025-09-10 21:05:33,290 INFO: 查询附件: [] [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/ai_chat_routes.py:77]
2025-09-10 21:05:33,290 INFO: 知识库设置: {'data_source': 'auto', 'tables': {'outpatient': True, 'target': True, 'drg': True}, 'dimensions': {'department': True, 'specialty': True, 'target_completion': True, 'trend': True}, 'time_range': 'all'} [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/ai_chat_routes.py:78]
2025-09-10 21:06:04,110 INFO: 查询处理完成，耗时: 30.82秒 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/ai_chat_routes.py:86]
2025-09-10 21:07:47,936 INFO: 医疗工作量系统启动 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:212]
2025-09-10 21:07:47,936 INFO: 开始初始化数据库... [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:127]
2025-09-10 21:07:47,936 INFO: 数据库URI: sqlite:////home/alfred/multiproject/医疗指标平台/medicalman/instance/medical_workload.db [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:130]
2025-09-10 21:07:47,936 INFO: 数据库路径: /home/alfred/multiproject/医疗指标平台/medicalman/instance/medical_workload.db [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:132]
2025-09-10 21:07:47,936 INFO: 数据库路径是否存在: True [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:133]
2025-09-10 21:07:47,937 INFO: 数据库初始化完成 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:136]
2025-09-10 21:07:47,948 INFO: 演示数据初始化完成 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:142]
2025-09-10 21:10:57,309 INFO: 用户查询: {"timestamp": "2025-09-10 21:10:57", "username": "guest", "query": "3", "success": null} [in /home/alfred/multiproject/医疗指标平台/medicalman/app/utils/logger.py:82]
2025-09-10 21:10:57,309 INFO: 查询附件: [] [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/ai_chat_routes.py:77]
2025-09-10 21:10:57,309 INFO: 知识库设置: {'data_source': 'auto', 'tables': {'outpatient': True, 'target': True, 'drg': True}, 'dimensions': {'department': True, 'specialty': True, 'target_completion': True, 'trend': True}, 'time_range': 'all'} [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/ai_chat_routes.py:78]
2025-09-10 21:11:05,888 INFO: 查询处理完成，耗时: 8.58秒 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/ai_chat_routes.py:86]
2025-09-10 21:20:59,275 INFO: 医疗工作量系统启动 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:212]
2025-09-10 21:20:59,275 INFO: 开始初始化数据库... [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:127]
2025-09-10 21:20:59,275 INFO: 数据库URI: sqlite:////home/alfred/multiproject/医疗指标平台/medicalman/instance/medical_workload.db [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:130]
2025-09-10 21:20:59,275 INFO: 数据库路径: /home/alfred/multiproject/医疗指标平台/medicalman/instance/medical_workload.db [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:132]
2025-09-10 21:20:59,275 INFO: 数据库路径是否存在: True [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:133]
2025-09-10 21:20:59,276 INFO: 数据库初始化完成 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:136]
2025-09-10 21:20:59,286 INFO: 演示数据初始化完成 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:142]
2025-09-10 21:21:17,153 INFO: 用户查询: {"timestamp": "2025-09-10 21:21:17", "username": "guest", "query": "看下昨天的业绩", "success": null} [in /home/alfred/multiproject/医疗指标平台/medicalman/app/utils/logger.py:82]
2025-09-10 21:21:17,154 INFO: 查询附件: [] [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/ai_chat_routes.py:77]
2025-09-10 21:21:17,155 INFO: 知识库设置: {'data_source': 'auto', 'tables': {'outpatient': True, 'target': True, 'drg': True}, 'dimensions': {'department': True, 'specialty': True, 'target_completion': True, 'trend': True}, 'time_range': 'all'} [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/ai_chat_routes.py:78]
2025-09-10 21:21:21,620 ERROR: 系统错误: {"timestamp": "2025-09-10 21:21:21", "message": "数据库连接错误: no such table: 门诊量", "error_code": 1001, "error_type": "DATABASE_ERROR"} [in /home/alfred/multiproject/医疗指标平台/medicalman/app/utils/logger.py:119]
2025-09-10 21:21:21,621 ERROR: 系统错误: {"timestamp": "2025-09-10 21:21:21", "message": "查询执行错误: no such table: 门诊量", "error_code": 1002, "error_type": "DATABASE_ERROR", "details": {"query": "SELECT 科室, 专科, 日期, 数量 \nFROM 门诊量 \nWHERE 日期 = DATE('now', '-1 day');"}} [in /home/alfred/multiproject/医疗指标平台/medicalman/app/utils/logger.py:119]
2025-09-10 21:21:21,623 INFO: 查询处理完成，耗时: 4.47秒 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/ai_chat_routes.py:86]
2025-09-10 21:21:25,858 INFO: 获取仪表盘数据: date_range=week, start_date=2025-03-22, end_date=2025-03-28 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/dashboard_routes.py:607]
2025-09-10 21:21:34,654 INFO: 创建finance_summary表并插入示例数据 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/analytics_routes.py:828]
2025-09-10 21:21:36,389 INFO: 请求科室工作量数据 - 开始: 2024-09-10, 结束: 2025-09-10, 科室: [] [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/analytics_routes.py:534]
2025-09-10 21:21:36,389 INFO: 执行SQL查询: 
        SELECT date, department, outpatient_count, inpatient_count, 
               surgery_count, emergency_count, consultation_count, total_count
        FROM department_workload
        WHERE date BETWEEN ? AND ?
         ORDER BY date, department 参数: ['2024-09-10', '2025-09-10'] [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/analytics_routes.py:554]
2025-09-10 21:21:36,397 INFO: 请求科室工作量数据 - 开始: 2024-09-10, 结束: 2025-09-10, 科室: [] [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/analytics_routes.py:534]
2025-09-10 21:21:36,397 INFO: 执行SQL查询: 
        SELECT date, department, outpatient_count, inpatient_count, 
               surgery_count, emergency_count, consultation_count, total_count
        FROM department_workload
        WHERE date BETWEEN ? AND ?
         ORDER BY date, department 参数: ['2024-09-10', '2025-09-10'] [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/analytics_routes.py:554]
2025-09-10 21:21:36,405 INFO: 科室工作量数据查询成功，返回 5490 条记录 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/analytics_routes.py:576]
2025-09-10 21:21:36,416 INFO: 科室工作量数据查询成功，返回 5490 条记录 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/analytics_routes.py:576]
2025-09-11 20:41:32,323 INFO: 医疗工作量系统启动 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:212]
2025-09-11 20:41:32,323 INFO: 开始初始化数据库... [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:127]
2025-09-11 20:41:32,323 INFO: 数据库URI: sqlite:////home/alfred/multiproject/医疗指标平台/medicalman/instance/medical_workload.db [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:130]
2025-09-11 20:41:32,323 INFO: 数据库路径: /home/alfred/multiproject/医疗指标平台/medicalman/instance/medical_workload.db [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:132]
2025-09-11 20:41:32,323 INFO: 数据库路径是否存在: True [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:133]
2025-09-11 20:41:32,324 INFO: 数据库初始化完成 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:136]
2025-09-11 20:41:32,336 INFO: 演示数据初始化完成 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/__init__.py:142]
2025-09-11 20:41:41,915 INFO: 认证活动: {"timestamp": "2025-09-11 20:41:41", "user_id": 1, "action": "login", "status": "success"} [in /home/alfred/multiproject/医疗指标平台/medicalman/app/utils/logger.py:243]
2025-09-11 20:41:42,796 INFO: 获取仪表盘数据: date_range=week, start_date=2025-03-22, end_date=2025-03-28 [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/dashboard_routes.py:607]
2025-09-11 20:41:57,069 INFO: 用户查询: {"timestamp": "2025-09-11 20:41:57", "username": "guest", "query": "看下业绩趋势", "success": null} [in /home/alfred/multiproject/医疗指标平台/medicalman/app/utils/logger.py:82]
2025-09-11 20:41:57,070 INFO: 查询附件: [] [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/ai_chat_routes.py:77]
2025-09-11 20:41:57,071 INFO: 知识库设置: {'data_source': 'auto', 'tables': {'outpatient': True, 'target': True, 'drg': True}, 'dimensions': {'department': True, 'specialty': True, 'target_completion': True, 'trend': True}, 'time_range': 'all'} [in /home/alfred/multiproject/医疗指标平台/medicalman/app/routes/ai_chat_routes.py:78]
2025-09-11 20:42:03,352 ERROR: 系统错误: {"timestamp": "2025-09-11 20:42:03", "message": "数据库连接错误: no such table: 门诊量", "error_code": 1001, "error_type": "DATABASE_ERROR"} [in /home/alfred/multiproject/医疗指标平台/medicalman/app/utils/logger.py:119]
